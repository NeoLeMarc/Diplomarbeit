

%%%------------------------------------------------ERGEBNISSE(KEINE BEWERTUNG)----------------------------------------------------

\chapter{Ergebnisse}\label{Ergebnisse}

In diesem Kapitel wird die entwickelte Lösung einer ausführlichen Evaluation unterzogen. Die sich hierbei
ergebenden Ergebnisse werden lediglich faktisch dargestellt, eine Bewertung erfolgt an dieser Stelle nicht;
diese wird in Kapitel~\ref{Diskussion} separat vorgenommen.


\section{Realisierbarkeit}
\subsection{Integrierbarkeit in den \emph{Erste-Hilfe-Sensor}}
\nomenclature{MANVNode}{Test- und Entwicklungsplatine für den kabellosen \emph{Erste-Hilfe-Sensor}.}
Die \emph{MANVNode} dient\,--\,neben ihrer Funktion als Test- und Entwicklungsplatine für die Firmware zur 
Ansteuerung der \emph{ZigBit}-Module\,--\,als Nachweis der Integrierbarkeit der in dieser Arbeit vorgestellten
Lösung in den \emph{Erste-Hilfe-Sensor}. Hierzu wurde beim Entwurf darauf geachtet, dass neben dem
\emph{ZigBit}-Modul keine weiteren Hardwarebauteile notwendig sind, die nicht auf der Platine des
\emph{Erste-Hilfe-Sensors} vorhanden sind. Darüber hinaus wurde die selbe Mikrocontroller-Architektur
verwendet, die auch im \emph{Erste-Hilfe-Sensor} zum Einsatz kommt, so dass die entsprechenden
Teile der \emph{Firmware} 1:1 übernommen werden können.

\subsection{Interoperabilität aller Komponenten}
\Abbildungps{!htb}{1}{diagramme/versuchsaufbau_integrationstest.pdf}{intergrationstest_setup_diagramm}{Diagramm des Aufbaus des \emph{Integrationstests}.}
\Abbildungps{!htb}{1}{diagramme/integrationstest_setup.jpg}{intergrationstest_setup_diagramm}{Photo des Aufbaus des \emph{Integrationstests}.}
\Abbildungps{!htb}{1}{diagramme/integrationstest_gui.png}{intergrationstest_gui}{Screenshot der \emph{MANVGui} während des Integrationstests.}
Da \emph{MANVSuite} und \emph{MANVConnector} in zwei verschiedenen Arbeiten (vgl. \cite{Jan}) 
entworfen wurden, muss die Interoperabilität zwischen allen Komponenten gezeigt werden. Hierzu
wurde ein umfassender Integrationstest durchgeführt.

\subsubsection{Durchführung}
\nomenclature{Setup}{Aufbau}
\nomenclature{Virtuelle Maschine}{In Software implementierter, uirtueller Computer.}
In einem ersten Test wurde eine \emph{MANVNode} über den \emph{MANV-USB-Stick} an den \emph{MANV-Connector}
angeschlossen und die \emph{MANVSuite} ausgeführt. Nun wurde gezeigt, dass sowohl die Übertragung von der \emph{MANVNode}
zur \emph{MANVSuite} als auch umgekehrt die Übertragung von Befehlen von der \emph{MANVSuite} zu der \emph{MANVNode}
funktionieren.\\
In einem zweiten Test wurde nun obiges \emph{Setup} durch das Hinzufügen von 4 weiteren \emph{MANVNodes} erweitert. Hierzu
wurden auch wieder Daten in beide Richtungen übertragen. Hierbei wurde insbesondere darauf geachtet, dass sich die
einzelnen \emph{MANVNodes} nicht untereinander stören, sowie dass alle Daten in der \emph{MANVSuite} korrekt zugeordnet
und dargestellt wurden.\\
Obiges \emph{Setup} wurde nun um 5 \emph{ZigBee-Router} erweitert und alle Tests wurden erneut durchgeführt.\\
Im letzten Schritt wurde nun noch die Skalierbarkeit des Systems überprüft. Hierzu wurde mit Hilfe zweier Notebooks
sowie dem Einsatz von Hardwarevirtualisierung jede Softwarekomponente auf eine eigene \emph{Virtuelle Maschine} installiert. Diese
wurden nun abwechselnd über beide Notebooks verteilt, so dass jede Kommunikation zwangsläufig über das Netzwerk
stattfinden musste. Nun wurden alle obigen Tests noch einmal wiederholt.

\subsubsection{Ergebnisse}
Alle Tests konnten erfolgreich durchgeführt werden. Die Interoperabilität aller Komponenten sowie die Verteilbarkeit
über verschiedene Rechner konnte gezeigt werden.

\subsection{Austauschbarkeit des \emph{MANVConnectors}}
Zur Demonstation der Austauschbarkeit des \emph{MANVConnectors} wurde in \cite{Jan} ein Simulator für den 
\emph{MANVConnector} geschrieben. Dieser implementiert die selbe \emph{Corba}-Schnittstelle wie der 
\emph{MANVConnector}, führt jedoch keine Kommunikation über das Netzwerk durch. Stattdessen besitzt
der Simulator eine graphische Benutzeroberfläche, über die zum einen Ereignisse von Hand ausgelöst, zum
anderen empfangene Befehle in einem Fenster dargestellt werden können. Die Übertragung von Daten wurde
in beide Richtungen erfolgreich getestet, die Austauschbarkeit des \emph{MANVConnectors} damit
erfolgreich demonstriert.

\subsection{Anbindbarkeit an externe Software}\label{anbindbarkeit_an_externe_software}
Eine zentrale Designentscheidung war die Verwendung einer offenen \emph{Corba}-Schnittstelle zur Anbindung
von externer Software an die \emph{MANVSuite}. Dass dies effizient durchführbar ist, zeigt der folgende
Test.

\subsubsection{Durchführung}
\nomenclature{Javascript}{\emph{Skriptsprache}, die vor allem in \emph{Webbrowsern} eingesetzt wird.}
\nomenclature{Webbrowser}{Programm zum Anzeigen von Webseiten.}
\nomenclature{Browser}{Siehe \emph{Webbrowser}.}
\nomenclature{Webinterface}{Graphische Benutzeroberfläche auf Basis einer Webseite.}
\nomenclature{JSON}{Datenübertragungsformat von Webservern zu \emph{Webbrowsern}.}
\nomenclature{Webserver}{Software, die Webseiten ausliefert.}
\nomenclature{AJAX}{Technologie zur Realisierung von Benutzeroberflächen auf Basis von Webseiten unter
                    Einsatz von \emph{Javascript} und \emph{JSON}.}
\nomenclature{HTTP}{Hypertext Transfer Protocol\,--\,Protokoll zur Übertragung von Webseiten.}
\nomenclature{Symbian}{Betriebssystem für ein Nokia-Handys.}
Zum Nachweis der Anbindbarkeit von externer Software über die \emph{Corba}-Schnittstelle wurde entschieden,
eine Schnittstelle zu einem \emph{Webinterface} zu implementieren. Das \emph{Webinterface} selbst ist
eine einfache \emph{HTML}-Seite, die über \emph{Javascript} eine graphische Benutzeroberfläche für das
Sensornetzwerk implementiert. Dieses muss nun zunächst mit Daten aus dem Sensornetzwerk versorgt werden. 
Dazu stellt dieses \emph{Javascript} einmal pro Sekunde eine Verbindung zum \emph{Webserver} her
und holt die Daten im \emph{JSON}-Format ab. Befehle, die an das Sensornetzwerk gesendet werden,
werden über spezielle \emph{HTTP-GET}-Anfragen kodiert. Insgesamt wird
diese Vorgehensweise auch als \emph{AJAX} bezeichnet und bildet die Grundlage der \emph{Web-2.0}-Technologie.
Es musste also ein Adapter von \emph{Corba} zu \emph{AJAX} realisiert werden. Die Details dieser
Implementierung sind in Anhang~\ref{anhang_beschreibung_software} beschrieben.\\
Darüber hinaus wird in \cite{Jan} beschrieben, wie ein \emph{Symbian}-basiertes \emph{Nokia}-Mo\-bil\-te\-le\-fon 
an die \emph{MANVSuite} angebunden wird. Hierzu wurde eine in \emph{C++} programmierte Lösung 
eingesetzt.

\subsubsection{Ergebnisse}
Die Anbindung des \emph{Webinterfaces} an die \emph{MANVSuite} konnte erfolgreich gezeigt werden. Die
Ergebnisse lassen sich ohne weiteres auf andere Schnittstellenformate übertragen. Über die Anbindung
des \emph{Symbian} basierten Mobiltelefons konnte darüber hinaus gezeigt werden, dass eine solche
Anbindung sogar über Plattform- und Programmiersprachengrenzen hinweg realisiert werden kann. 

\section{Leistungsaufnahme des ZigBit-Moduls}
\nomenclature{Multimeter}{Mehrzweckmessgerät, das unter anderem Strom und Spannung messen kann.}
\nomenclature{Oszilloskop}{Messgerät zur optischen Darstellung von zeitlichen Spannungsverläufen.}
\nomenclature{Ohmsches Gesetz}{$U = R \cdot I$}
\nomenclature{U}{Spannung.}
\nomenclature{R}{Widerstand.}
\nomenclature{I}{Strom.}
\nomenclature{Shunt}{Niederohmiger Widerstand zur Messung von Strömen mit einem Spannungsmessgerät.}
Zur Bestimmung der Leistungsaufnahme~-- umgangssprachlich auch Strom\-ver\-brauch genannt~-- wurden mehrere Messungen 
durchgeführt.
Da der Strombedarf insbesondere bei Einsatz des Energiesparmodus sehr stark schwankt, sind herkömmliche Messungen
z.B. über ein Multimeter nicht geeignet. Daher wurde eine indirekte Messung über den Spannungsabfall an einem 
Widerstand durchgeführt. Dieser wurde in die Stromversorgung des \emph{ZigBit}-Moduls eingebracht. Der 
Spannungsabfall über diesem Widerstand wurde nun sowohl mit einem \emph{Oszilloskop} als auch mit einem \emph{Multimeter}
gemessen. Hierzu wurde zunächst die Form des Spannungsverlaufs analysiert. Dann wurden einzelne Messpunkte innerhalb 
des Spannungsverlaufs ausgewählt, für die nun der Wert der abfallenden Spannung gemessen wurde. Über das Ohmsche Gesetz 
konnte nun aus der abfallenden
Spannung die Stromstärke bestimmt werden. Für die einzelnen Messungen wurde ein Oszilloskop der Marke \emph{Tektronix}, 
Modell \emph{TDS2002B} verwendet. Die Messungen wurden zusätzlich mit einem Multimeter verifiziert,
um Kalibrationsfehler des \emph{Oszilloskops} auszuschliessen. Es wurde ein Widerstand mit einem Wert von $20,1\,\Omega$
verwendet.

\subsection{Leistungsaufnahme im Normalbetrieb}\label{leistungsaufnahme_normalbetrieb}
\label{ergebnis_normal}
\Abbildungps{!htb}{0.75}{oszi/normalbetrieb_router.jpg}{oszi_normalbetrieb_router}{Router oder Koordinator im Normalbetrieb. 
%    Der Strombedarf beträgt hierbei konstant 23,4~mA, was ca. 70~mW entspricht.} 
}   
\Abbildungps{!htb}{0.75}{oszi/normalbetrieb_client.jpg}{oszi_normalbetrieb_client}{Endknoten im Normalbetrieb ohne Energiesparmodus. 
%        Auffällig sind die \emph{Peaks}, in denen sich der Knoten im Empfangsmodus befindet. 
%        Die \emph{Peaks} haben eine 
%    Länge von 40~ms und einen Betrag von 23,4~mA. Ausserhalb eines \emph{Peaks} beträgt der Strombedarf 10,7~mA.
%    Insgesamt ergibt 
%    sich ein Mittelwert von 11,18~mA, was ca. 33,54~mW entspricht. Dies ist weniger als die Hälfte des Strombedarfs
%    eines Routers oder Koordinators.} 
}
\Abbildungps{!htb}{1}{diagramme/spannungsverlauf_client_normal.pdf}{spannungsverlauf_client_normal}{Analyse des 
    Spannungsverlaufs eines Clients im Normalbetrieb.}
\Abbildungps{!htb}{0.75}{oszi/empfangen_details.jpg}{oszi_empfangen_details}{Detailaufnahme eines Empfangsmodus-\emph{Peaks}.
%    Erkennbar ist die Impulsbreite von 40ms.
}

\nomenclature{Server}{Komponente, die einen Dienst anbietet.}
\nomenclature{Client}{Komponente, die einen Dienst nutzt.}
Als Normalbetrieb wurde der Zustand angenommen, in dem das \emph{ZigBit}-Modul einem \emph{ZigBee}-Netzwerk beigetreten
ist und der Energiesparmodus nicht zur Anwendung kommt. Bei der Messung wurde schnell klar, dass sich hierbei die
Funktionsweise von eines \emph{FFD} (also \emph{Router} und \emph{Connector}) drastisch von der eines \emph{RFD}s (also 
eines Clients) 
unterscheiden. Ein \emph{FFD} befindet sich immer im Empfangsmodus, d.h. es hat immer eine maximale Leistungsaufnahme. 
Die entsprechende Messung ist in Abbildung~\ref{oszi_normalbetrieb_router} zu erkennen. Hier wurde ein Spannungsabfall
von 473~mV gemessen, was bei dem verwendeten Messwiderstand einem Strom von 23,5~mA oder einer Leistungsaufnahme ca. 70~mW entspricht.\\
Komplett anders ist hingegen das Verhalten eines Clients. Betrachtet man die entsprechende Messung in
Abbildung~\ref{oszi_normalbetrieb_client}, ist eine Basislinie von 215~mV mit periodischen \emph{Peaks} erkennbar. 
In Abbildung~\ref{oszi_empfangen_details} ist eine Detailmessung eines solchen \emph{Peaks} zu sehen.  Gut zu erkennen ist zum 
einen der Betrag des Spannungsabfalls von rund 473~mV sowie einer Dauer von genau 40~ms. Zwischen den \emph{Peaks} kehrt der 
Spannungabfall für genau eine Sekunde auf den Wert der Basislinie, also 215~mV zurück, auf die wieder ein \emph{Peak} folgt.
Der Wert von 473~mV legt die Vermutung nahe, dass es sich bei den \emph{Peaks} um einen periodischen Empfangsvorgang handelt,
d.h. das das \emph{ZigBit}-Modul jede Sekunde für genau 40~ms empfangsbereit ist. Diese Vermutung konnte durch weitere
Tests bestätigt werden. Zur Bestimmung des Strombedarfs eines Clients ergibt sich daher folgende Rechnung:

\begin{align}
    U_{Client} &= \frac{t_{Basislinie} \cdot U_{Basislinie} + t_{Peak} \cdot U_{Peak}}{t_{Basisline} + t_{Peak}}
   \label{eqn:UClient}\\
    I_{Client} &= \frac{U_{Client}}{R_{Shunt}}
    \label{eqn:IClient}
\end{align}

Wobei die einzelnen Formelsymbole folgende Bedeutung haben:

\begin{tabular}{ll}
$U_{Client}     $ & Durchschnittlicher Spannungabfall am Messwiderstand beim Betrieb \\&des Clients\\
$t_{Basislinie} $ & Dauer der Basislinie \\
$U_{Basislinie} $ & Spannungsabfall der Basislinie \\
$t_{Peak}       $ & Dauer eines Peaks\\ 
$U_{Peak}       $ & Spannungsabfall am Messwiderstand während eines Peaks \\
$I_{Client}     $ & Strombedarf eines Clients \\
$R_{Shunt}      $ & Betrag des Messwiderstands\\
\end{tabular}

Setzt man nun die gemessenen Werte 

\begin{center}
    $t_{Basislinie} = 1000\,\text{ms}$,\quad
    $t_{Peak}       = 40\,\text{ms}$,\quad
    $U_{Basislinie} = 215\,\text{mV}$,\quad
    $U_{Peak}       = 473\,\text{mV}$
\end{center}

in Formel~\ref{eqn:UClient} ein, folgt für den Spannungsabfall

\begin{align*}
    &U_{Client} = \frac{1000\,\text{ms} \cdot 215\,\text{mV} + 40\,\text{ms} \cdot 470\,\text{mV}}{1000\,\text{ms} + 40\,\text{ms}} = 224,9\,\text{mV}
\end{align*}

wodurch sich mit einem Widerstand von 

\begin{center}$
    R_{Shunt} = 20,1\,\Omega
    $
\end{center}

ein Wert von 11,19~mA für $I_{Client}$ ergibt. Dies entspricht bei einer Versorgungsspannung von 3,0~V einer Leistungsaufnahme
von ca. 33,6~mW.

\subsection{Leistungsaufnahme bei Verwendung des Energiesparmodus.}
\Abbildungps{!htb}{0.75}{oszi/erwachen_1.jpg}{oszi_erwachen}{Aus dem Energiesparmodus erwachter Client.
%   Erkennbar ist, dass während der Schlafphase der Strombedarf praktisch auf 0 sinkt. Direkt nach dem Erwachen
%   wird ein Empfangsvorgang durchgeführt; die danach folgende Phase ist analgo zu Abbildung~\ref{oszi_normalbetrieb_client}.
%   Gut zu Erkennen ist, dass der Energiesparmodus praktisch keinen zusätzlichen Overhead bedeutet.
}    

\Abbildungps{!htb}{1}{diagramme/spannungsverlauf_client_energiesparmodus.pdf}{spannungsverlauf_client_energiesparmodus}{Analyse des Spannungsverlaufs eines Clients bei Nutzung des Energiesparmodus.}
\Abbildungps{!htb}{0.75}{oszi/powersave_periodic.jpg}{oszi_powersave_periodic}{Client, der das periodische Aufrufen
    des Energiesparmodus nutzt.
%   Die Schlafphase hat hier eine Länge von 5 Sekunden, die Wachphase ist genau 1 Sekunde lang. Der
%   Strombedarf beträgt im Mittel nur noch 1,86mA, was ca. 5,58mW entspricht.}
}

\nomenclature{Serialnet}{\emph{Firmware} für die \emph{ZigBee}-Module der Herstellers \emph{Atmel}.}
\nomenclature{BitCloud}{\emph{SDK} zur Erstellung von \emph{Firmware} für die \emph{ZigBee}-Module der Firma \emph{Atmel}.}
\nomenclature{Peak}{Lokales Maximum (oder je nach Messrichtung auch Minimum) eines Spannungsverlaufs.}
Die Verwendung des Energiesparmodus~-- im Datenblatt auch als \emph{Sleepmode}, also Schlafmodus, bezeichnet~-- ist eine
Möglichkeit, den Strombedarf eines als Client konfigurierten \emph{ZigBit}-Moduls weiter zu reduzieren. Wie in 
Abbildung~\ref{oszi_erwachen} zu sehen ist, sinkt der Strombedarf während des Energiesparmodus auf praktisch 
0\footnote{Im Datenblatt ist ein Strombedarf von weniger als $6~\mu{}A$ angegeben.}. Sobald das Modul aus dem 
Energiesparmodus in den Normalbetrieb zurückkehrt, wird sofort ein Empfangsvorgang gestartet. Bis zum nächsten Aufrufen des 
Energiesparmodus verhält sich das Modul wie in Abschnitt~\ref{ergebnis_normal} beschrieben. Der Energiesparmodus kann
entweder manuell\footnote{z.B. mit dem Befehl \emph{AT+WSLEEP} bei Verwendung der \emph{Serialnet-Firmware}.} oder in einem 
einstellbaren Intervall periodisch aufgerufen werden. Der Spannungsabfall während des periodischen Aufrufens ist in
Abbildung~\ref{oszi_powersave_periodic} zu sehen. Bei der Betriebsart des periodischen Aufrufens wird über zwei Parameter,
$t_{sleep}$ und $t_{awake}$, die Dauer der Schlaf- bzw. Wachphase angegeben. Der Parameter $t_{awake}$ darf hierbei die Dauer
einer Empfangsphase, also 40~ms, nicht unterschreiten. Für $t_{sleep}$ gilt eine Mindestdauer von 100~ms.\\
Interessant ist nun die Bestimmung des durchschnittlichen Strombedarfs bei Verwendung des Energiesparmodus
in Abhängigkeit von den Parametern $t_{awake}$ und $t_{sleep}$. In erster Näherung kann für den Strombedarf im Wachzustand
Gleichung~\ref{eqn:IClient} verwendet werden\footnote{Dies ist eigentlich nicht ganz korrekt.
Zur genauen Bestimmung des Strombedarfs müssten die einzelnen Intervalle 
eigentlich einzeln betrachtet werden. Allerdings ist der sich hieraus ergebende Fehler so gering, dass er in der Praxis zu 
vernachlässigen ist.}. Insgesamt ergibt sich der Strombedarf zu:

\begin{equation}
   I_{Powersave} = \frac{I_{Client} \cdot t_{awake}}{t_{awake} + t_{sleep}}
\end{equation}

In Tabelle~\ref{werte_Ipowersave} ist der Strombedarf für einige exemplarische Werte von $t_{sleep}$ und $t_{awake}$ 
aufgeführt.

\begin{table}
    \begin{center}
        \begin{tabular}{lll}
            \textbf{t\textsubscript{sleep}} & \textbf{t\textsubscript{awake}} & \textbf{I\textsubscript{Powersave}} \\
            1~s  & 40~ms  & 0,45~mA \\
            1~s  & 500~ms & 5,59~mA \\
            1~s  & 1~s    & 5,59~mA \\
            5~s  & 500~ms & 1,02~mA \\
            5~s  & 1~s    & 1,86~mA \\
            10~s & 500~ms & 0,54~mA \\
            10~s & 1~s    & 1,01~mA 
        \end{tabular}
    \end{center}
    \caption{Berechnung von $I_{Powersave}$ für exemplarische Werte von $t_{sleep}$ und $t_{awake}$.}
    \label{werte_Ipowersave}
\end{table}

\subsection{Sonderfälle}\label{leistungsaufnahme_sonderfaelle}
\Abbildungps{!htb}{0.75}{oszi/not_joined.jpg}{oszi_not_joined}{Client mit deaktiviertem Empfangsmodus.
    %deaktiviert. Der 
    %Strombedarf beträgt konstant 10,7~mA.}
    }
\Abbildungps{!htb}{0.75}{oszi/joined.jpg}{oszi_joined}{Beitrittsvorgang eines Clients in ein Netzwerk.
    %Bevor der Client dem 
    %Netzwerk beigetreten ist, befindet er sich durchgehend im Empfangsmodus und benötigt 23,4~mA. Sobald er dem Netzwerk
    %beigetreten ist, entspricht entspricht der Strombedarf dem in Abbildung~\ref{oszi_normalbetrieb_client} dargestellten
    %Verhalten.} 
    }
\Abbildungps{!htb}{0.75}{oszi/joined2.jpg}{oszi_connection_lost}{Client, der die Verbindung zum Netzwerk verloren hat.}
%    Dieser Client hat kurzzeitig die Verbindung zum Netzwerk 
%    verloren. In dieser Zeit befand er sich im Dauerempfangsmodus und hat 23,4~mA. benötigt.}

So lange ein Client keinem Netzwerk beigetreten ist befindet er sich dauerhaft im Empfangsmodus. Das selbe Verhalten liegt
vor, wenn eine bestehende Netzwerkverbindung verloren gegangen ist. Wie in Abbildung~\ref{oszi_connection_lost} zu sehen
ist, steigt der Strombedarf in diesem Fall dauerhaft auf 23,4~mA an. Dazu kommt, dass keine Nutzung des Energiesparmodus
möglich ist, so lange keine Verbindung zu einem Netzwerk besteht. Dies kann eine Steigerung des durchschnittlichen
Strombedarfs um mehr als den Faktor 10 bewirken, was eine entsprechend schnelle Entladung der verwendeten Stromquelle bedeutet.
Es ist daher wichtig, darauf zu achten, dass alle verwendeten Sensoren möglichst selten die Verbindung zum 
Netzwerk verlieren.

\subsection{Batterielaufzeit}\label{batterielaufzeit}
In Abschnitt~\ref{analyse_powermanagement} wurde bereits eine grobe Überschlagsrechnung der Batterielaufzeit
Anhand der Werte aus dem Datenblatt vorgenommen. Diese sollen nun mit den oben gemessenen Werten konkretisiert
werden. Als Strombedarf des \emph{Erste-Hilfe-Sensors} werden hierzu die in \cite{Marco} gemessenen Werte von
16,8~mA angenommen. Als Stromquelle soll eine Knopfzelle vom Typ \emph{CR2032} mit einer Kapazität von 240~mAh 
dienen\footnote{Die nachfolgenden Berechnungen gehen von einer Entladung der Batterie unter idealen Bedingungen aus. 
Nicht berücksichtigt sind daher Verringerungen der Ladung durch die Entnahme zu großer Ströme. Dies muss in der
Stromversorgung des \emph{Erste-Hilfe-Sensors} entsprechend berücksichtigt werden.}. Unter 
idealen Bedingungen ergibt sich für den \emph{Erste-Hilfe-Sensor} alleine eine Laufzeit von 14,3~Stunden.\\
Ohne Verwendung des Energiesparmodus wurde für den Strombedarf des \emph{ZigBit}-Moduls ein mittlerer Strombedarf von 
11,2~mA. In Verbindung mit dem \emph{Erste-Hilfe-Sensor} ergibt sich ein Gesamtstrombedarf von 28~mA, was einer
Laufzeit von 8,5 Stunden entspricht.\\
Für den Energiesparmoduses in einer 5:1-Konfiguration ergibt sich laut Tabelle~\ref{werte_Ipowersave} eine Absenkung
des Strombedarfs des \emph{ZigBit}-Moduls auf 1,86~mA, woraus sich in Verbindung mit dem \emph{Erste-Hilfe-Sensor}
ein Gesamtbedarf von rund 18.7~mA ergibt. Dies entspricht einer Laufzeit von ca. 12,8 Stunden.\\

\section{Reichweite}
Zur Bestimmung der Reichweite wurden sowohl innerhalb von Gebäuden als auch im Freien Messungen durchgeführt. 
Es wurde schnell klar, dass die Ergebnisse sehr stark von den Gegebenheiten der Umgebung sowie der Höhe von
Sender und Empfänger abhängig sind. Die größte Reichweite ist bei direkter Sichtverbindung
sowie einer Höhe von mindestens 1~m über dem Boden für Sender und Empfänger zu erreichen. 
Unterhalb des Senders sollten sich möglichst keine Metalle befinden, als besonders schlecht hat sich die 
Positionierung des Senders auf dem Dach eines PKW erwiesen. 

\subsection{Reichweite im Freien}
\nomenclature{PKW}{Personenkraftwagen.}
Alle Tests zur Reichweite im Freien wurden auf dem Geländer der Westhochschule der Universität Karlsruhe (TH)
durchgeführt. Hierzu wurde eine \emph{MANVNode} auf einem Pfosten in einer Höhe von einem Meter angebracht
und auf periodisches Senden bei maximaler Sendeleistung konfiguriert.  Nun wurde ein Notebook mit einem 
\emph{MANV-USB-Stick} so lange von der \emph{MANVNode} entfernt, bis keine Pakete mehr empfangen wurden.
Nun wurde der Abstand wieder so lange verringert, bis wieder 100\% der gesendeten Pakete empfangen wurde.
Außerdem wurde als Gegenprobe ein Befehl an die \emph{MANVNode} gesendet und die Antwort empfangen. 
Als maximale Reichweite wurde nun die Entfernung gewertet, bei der gerade noch alle Pakete empfangen, 
sowie alle Befehle erfolgreich gesendet werden konnten. Die Entfernung zwischen Notebook und 
\emph{MANVNode} wurden nun mittels \emph{GPS} vermessen. Als maximale Reichweite ergab sich hierbei eine Entfernung
von etwas über 50~m.\\
Im nächsten Schritt wurde an die Position des Notebooks ein \emph{ZigBee}-Router aufgestellt und die Entfernung zu
diesem so lange vergrößert, bis gerade noch alle Pakete empfangen werden konnten. Insgesamt konnte durch
die Verwendung von zwei \emph{Routern} eine Gesamtreichweite von ca. 180~m erreicht werden, so dass von einer 
durchschnittlichen Reichweitenverlängerung von 50-70~m pro \emph{Router} ausgegangen werden kann.\\
Deutliche Einschränkungen bei der Reichweite traten auf, sobald sich Hindernisse wie Container, Häuser oder 
PKW in der Sichtverbindung zwischen Sender und Empfänger befanden. Diese ließen sich jedoch durch geschicktes
Positionieren der \emph{Router} sehr gut umgehen, so dass auch hier hohe Reichweiten erzielbar waren. 

\subsection{Reichweite innerhalb geschlossener Räume}
Die Reichweite innerhalb geschlossenere Räume hängt sehr stark von der Beschaffenheit dieser ab. Insbesondere
Metallkonstruktionen wie Treppengeländer und Stahlträger in Wänden wirken sich negativ auf die
Reichweite aus. Eine generische Aussage über die Reichweite innerhalb geschlossener Räume ist daher nur 
sehr schwer zu treffen. Diese hängt meist auch weniger von der Entfernung als von der Anzahl der
Wände zwischen Sender- und Empfänger ab. In diversen Tests hat sich hierbei ergeben, dass eine
Kommunikation durch zwei nicht tragende Wände hindurch gerade noch möglich ist.

\section{Maximale Teilnehmerzahl des Netzwerke}\label{maximale_teilnehmerzahl}

Eine praktische Messung der Teilnehmerzahl ist aus Kostengründen in einer Diplomarbeit natürlich nicht durchführbar. Daher
soll an dieser Stelle eine analytische Betrachtung erfolgen. Diese wird in Form einer Worst-Case Abschätzung durchgeführt, 
d.h. für alle Parameter werden die schlechtest möglichen Werte angenommen.\\
\\
Grundsätzlich gilt folgender Zusammenhang:

\begin{equation}
   Anzahl_{Teilnehmer} = \frac{Datenrate_{Netzwerk}}{Datenrate_{Teilnehmer}}
   \label{anzahl_teilnehmer}
\end{equation}

In dem Szenario überträgt jeder Teilnehmer alle 5~Sekunden ein Datenpaket, das den aktuellen Zustand beinhaltet.
Laut \cite{zigbee_specification} hat ein \emph{ZigBee}-Datenpaket eine maximale Größe von 128~Byte. Damit ergibt sich für die
benötigte Datenrate eines Teilnehmers:

\begin{equation}
    Datenrate_{Teilnehmer} = \frac{128\,\text{Byte}}{5\,\text{s}} = \frac{1024\,\text{Bit}}{5\,\text{s}} \approx \frac{0,2\,\text{kBit}}{\text{s}}
\end{equation}

Laut \cite{zigbee_specification} gilt: $Datenrate_{Netzwerk} = 250\,\text{kBit/s}$. Setzt man diese Werte nun in 
Gleichung~\ref{anzahl_teilnehmer} ergibt sich für die maximale Anzahl von Teilnehmern:

\begin{equation}
    Anzahl_{Teilnehmer} = \frac{250\,\text{kBit/s}}{0,2\,\text{kBit/s}} = 1250
\end{equation}

Unter Worst-Case-Bedingungen ergibt sich also eine maximale Anzahl von 1250 Teilnehmern.
