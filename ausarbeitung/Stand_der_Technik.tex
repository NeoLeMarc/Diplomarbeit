
%%%------------------------------------------------STAND DER TECHNIK------------------------------------------------------------------
\chapter{Stand der Technik}\label{Stand der Technik}

\section{Einleitung}
In diesem Kapitel wird der Stand der Technik von kabellosen Patientenüberwachungstechnologien untersucht. 
Hierzu wird zunächst in Abschnitt~\ref{kabellose_uebertragungsprotokolle} allgemein eine Reihe von potentiell
geeigneten Übertraungsprotokollen vorgestellt und jeweils kurz diskutiert, ob und wie gut diese als 
Basistechnologie für die Lösung der Problemstellung dieser Diplomarbeit geeignet sind. Im darauf folgenden
Abschnitt~\ref{produkte_zu_patientenueberwachung} wird dann die aktuelle Marktsituation fertiger Produkte,
die zur Überwachung von Patienten in einem MANV-Szenario in Frage kommen vorgestellt, und die Eignung dieser
Produkte diskutiert. Den Abschluss dieses Kapitels bildet Abschnitt~\ref{verwandte_projekte}, in dem
kurz auf ähnliche Projekte eingegangen wird, die momentan an anderer Stelle in Arbeit sind.

\section{Kabellose Übertragungsprotokolle}\label{kabellose_uebertragungsprotokolle}
    \subsection{Einführung}
        In diesem Abschnitt werden die gängisten Funkprotokolle kurz vorgestellt. Insbesondere wird erläutert,
        inwieweit das entsprechende Protokoll als Grundlage für das zu entwickelnde Sensornetz geeignet ist.

        Mit Ausnahme von DECT und GSM bzw. UMTS ist diesen Protokollen gemein, dass sie sich alle im ISM-Band 
        befinden. 

    \subsection{DECT}
        Bei DECT ("`Digital Enhanced Cordless Telecommunications"') handelt es sich um einen Standard, 
        der vor allem zur Anbindung von Schnurlostelefonen an eine Basisstation gedacht ist\footnote{Es gibt
        jedoch auch weitere Anwendungen wie z.B. Babyfone.}. 

        In Europa wird einn eigenes Frequenzband im Bereich von 1800 bis 1900 MHz verwendet, in dem 10 
        Kanäle zur Verfügung stehen. Pro Kanal können maximal 32kbit Nutzdaten pro Sekunde übertragen
        werden. Die maximal zulässige Sendeleistung beträgt 250mW, womit eine Reichweite von ca. 30-50
        Metern in Gebäuden und ca. 300m im Freien realisiert werden kann. Jede Basisstation kann
        bis zu 6 Geräte anbinden.

        Beim Einsatz außerhalb Europas muss bedacht werden, dass die Verwendung der Frequenzen von
        1800 bis 1900 MHZ hier evtl. nicht zulässig ist. In diesem Fall muss auf das ISM-Band 
        ausgewichen werden, welches sich hier mit anderen Anwendungen geteilt werden mus.

        DECT bietet eine optionale Verschlüsselung der Nutzdaten, welche jedoch im Jahr 2009 geknackt
        wurde, so dass DECT mittlerweile als unsicher gelten muss.

        Aufgrund der geringen Nutzdatenmenge sowie der Einschränkung auf 6 Teilnehmer ist
        DECT für den Einsatz als Sensornetz-Protokoll nicht geeignet.

    \subsection{GSM/UMTS}
        GSM sowie der Nachfolgestandard UMTS bilden die Grundlage der aktuellen Mobilfunktechnologie.
        Es handelt sich um eine Zellenbasierte Technologie, die im Falle von GSM Frequenzen im
        900MHz- und im 1,8GHz-Band verwendet. Für UMTS stehen insgesamt 19 Bänder im Bereich von 777MHz 
        bis 2,2GHz zur Verfügung. Die Kommunikation findet zwischen einem Mobiltelefon und einer
        Basisstation statt, wobei die maximale Sendeleistung 2W (im Falle von GSM) bzw 250mW (im Falle
        von UMTS) beträgt. Mit GSM-900 können im Freien bei Sichtkontakt Reichweiten bis zu 35km erreicht
        werden.\\
        \\
        Die Frequenzen für GSM und UMTS sind fest dem jeweiligen Netzbetreiber zugeordnet. Der Preis
        für einen Frequenzbereich ist sehr teuer. Bei der Versteigerung der UMTS-Frequenzen im 
        Jahr 2000 wurden Preise von bis zu 8 Milliarden Euro pro Lizenz erreicht. 
    \subsection{WLAN}\label{wlan}
        \subsubsection{Übersicht}
            WLAN oder Wi-Fi bezeichnet den heute gängigen Standard eines Funkprotokolls zum Aufbau
            von kabellosen lokalen Netzwerken. Es gibt mehrere Versionen des Standards, die verbreitetsten
            sind IEEE 802.11a, IEEE 802.11b/g und IEEE 802.11n. 

            Es sind zwei Betriebsmodi möglich:

            \begin{itemize}
                \item{Infrastruktur-Modus:} Eine zentrale Station ("`Access-Point"') dient als Basisstation
                                            für alle weitere Stationen. Jede Station, die am Netzwerk
                                            teilnimmt, muss hierzu die Signale des \textsl{Access-Points} 
                                            empfangen können.
                \item{Ad-hoc-Modus:} Diese Betriebsmodus kommt ohne zentrale Komponente aus. Es wird eine
                                     Peer-to-Peer-Verbindung zwischen allen am Netzwerk teilnehmenden 
                                     Stationen aufgebaut. Hierzu ist es notwendig, dass alle Stationen
                                     sich gegenseitig empfangen können.
            \end{itemize}

            Der Infrastruktur-Modus bietet gegenüber des Ad-Hoc-Modus' klare Vorteile: Im Gegensatz
            zum Ad-hoc-Modus ist es nicht notwendig, dass alle Stationen sich gegenseitig empfangen
            müssen, es reicht aus, wenn der Acces-Point empfangen werden kann. Hierdurch ist eine
            größere Ausbreitung des Netzwerks möglich als im Ad-Hoc-Modus. 

            Es werden verschiedene Datenübertragungsraten unterstützt. Standardmässig wird
            immer die größtmögliche Übertragungsrate gewählt, die Störungsfrei verwendet
            werden kann. Je weiter sich die Stationen voneinander entfernen, desto geringer
            wird die Übertragungsrate, bis schliesslich die niedrigst mögliche Übertragungsrate von
            1MBit/sec erreicht wird.

            Es gibt eine ganze Menge von Unterstandards, die sich durch zulässige Frequenzen, 
            Übertragungsraten und Sendeleistung unterscheiden. Teilweise ist auch Kanalbündelung 
            vorgesehen. Nicht jeder Standard kann in jedem Land eingesetzt werden, und die meisten
            Endgeräte unterstützen nur eine Teilmenge dieser Stanrdards. Hier sollen nur die
            wichtigsten drei Standards erwähnt werden.

        \subsubsection{IEEE 802.11b}
            Bei IEEE 802.11b handelt es sich um den ältesten WLAN-Standard, der bereits 1999 
            spezifiziert wurde. Dieser Standard wird praktisch von jedem WLAN fähigen 
            Endgerät unterstützt. Die Kommunikation findet im ISM-Band im Bereich von 2.4GHz
            statt. Je nach Land sind 11-14 Kanäle möglich, die sich jedoch teilweise überlappen.
            Dies führt dazu, dass maximal 3 Netzwerke ohne Störungen gleichzeitig betrieben werden
            können. Die maximale Sendeleistung beträgt 100mW. Es sind Übertragungsraten von 
            5,5 bis 11 MBit (brutto) möglich. Die Nettoübertragungsrate beträgt ca. 50\% der
            Bruttorate. Es sind Reichweiten bis 40m (Innen) bzw. 100m (Im Freien) möglich\cite{WirelessNetworking}.

        \subsubsection{IEEE 802.11g}
            Der IEEE 802.11g Standard stellt eine Erweiterung des IEEE 802.11b Standards da.
            Wesentliche Neuerung ist eine Erhöhung der Bruttodatenrate von 11 auf 54MBit/sec,
            von denen netto ca. 40\% zur Verfügung stehen. Erwähnenswert ist, dass die
            beiden Standards Interoperabel sind, d.h. ein 802.11b Gerät kann einem
            802.11g Netzwerk beitreten und umgekehrt. Dies ist auch der Grund, weshalb
            dieser Standard momentan am weitesten verbreitet ist.

        \subsubsection{IEEE 802.11a}
            Der IEEE 802.11a Standard verwendet Frequenzen im 5GHz Bereich. Er ist daher
            inkompatibel zum IEEE 802.11b/g Standard. Je nach Frequenzband sind 
            Sendeleistungen zwischen 30 und 1000mW zulässig. Mit dem passenden Frequenzband
            sind daher höhere Reichweiten als mit dem IEEE 802.11b/g Standard möglich.
            Die Bruttodatenrate beträgt bis zu 54MBit/sec. 
            Ein Vorteil des IEEE 802.11a Standards ist die Kommunikation im 5GHz Bereich.
            Aktuell ist dieser Bereich noch wenig genutzt, so dass in diesem
            Bereich oft ein störungsärmerer Betrieb als im 2,4GHz-Bereich möglich ist.
            Es ist jedoch zu erwarten, dass sich dies in Zukunft ändern wird.

        \subsubsection{Störsicherheit}\ref{WlanStoersicherheit}
            IEEE 802.11 verwendet den CSMA/CA\footnote{Carrier Sense Multiple Access with 
            Collision Avoidance. Zu deutsch: Gemeinsamer Medienzugriff mit Kollisionsvermeidung}-Algorithmus
            zur Störungsbehandlung. Möchte ein Station senden, so muss diese zunächst
            für einige Zeit lauschen, ob der zu verwendende Kanal auch wirklich frei ist.
            (Energy Detection).
            Ist der Kanal belegt, so wartet sie eine zufällige Zeit, bis sie erneut versucht,
            auf den Kanal zuzugreifen. Wichtig hierbei ist, dass es bei Funkprotokollen nicht
            möglich ist, eine Kollision zu erkennen um eine bestehende Übertragung abzubrechen,
            wie es z.B. bei \textsl{Ethernet} der Fall ist. Zur Vermeidung von Kollisionen
            kann bei IEEE 802.11 daher zusätzlich zu CSMA/CA eine Art Token-Passing einesetzt
            werden. Hier kommt RTS/CTS zum Einsatz: Möchte eine Station ein großes Datenpaket
            senden, so sendet diese zuerst ein RTS-Paket\footnote{Ready to send} an den Empfänger, 
            welcher dies mit einem CTS-Paket\footnote{Clear to send} quittiert. Erst wenn das
            CTS-Paket empfangen wurde, wird mit der Übertragung des eigentlichen Datenpakets
            begonnen. Für alle andere Stationen im Netzwerk ist nun klar, dass sie bis zur
            abgeschlossenen Übertragung dieses Paketes nicht auf das Netzwerk zugreifen
            dürfen.\\
            \\
            %Quelle: IEEE Standard
            Bei dem Einsatz der in IEEE 802.11i definierten Verschlüsselungsverfahren
            (WEP\footnote{Die Sicherheit von WEP ist bereits seit einigen Jahren
             kompromitiert. Es sollte nichtmehr verwendet werden}, WPA oder WPA2) wird
            lediglich die Nutzdaten des Paketes verschlüsselt. Die CTS/RTS-Pakete können
            weiterhin erkannt werden, so dass die Kollisionsverhinderung auch dann
            funktioniert, wenn die Pakete nicht entschlüsselt werden können (Diese 
            Situation ist z.B. in Mietshäusern oft anzutreffen, wo mehrere 
            unterschiedliche WLANs auf dem selben Kanal senden). Jedoch geht dies
            mit einer reduzierten Übertragungsrate für die einzelnen Netzwerke
            einher.\\
            \\
            Zusätzlich wird das in Abschnitt~\ref{DSSS} beschriebene DSSS-Verfahren
            eingesetzt, um schmallbandige Störungen auszufiltern. \\
            \\
            Ein häufiges Problem ist die Störung durch Bluetooth, da 
            Bluetooth und WLAN Geräte oft aufeinadertreffen (z.B. weil an einem
            Notebook Bluetooth-Maus und -Tastatur verwendet werden oder weil 
            ein PDA z.B. Schnittstellen für beide Protokolle besitzt).
            Wie in Abschnitt \ref{bluetooth} genauer erläutert besitzt Bluetooth
            79 Kanäle, welche bis zu 1600 mal pro Sekunde gewechselt werden.
            Problematisch ist nun, dass 22 dieser Kanäle in das 
            IEEE 802.11b/g-Frequenzspektrum fallen. Durch den häufigen
            Kanalwechsel, die geringeren Übertragungsraten so die 
            Möglichkeit, den Wechsel auf belegte Kanäle zu vermeiden ist diese
            Störung für Bluetooth deutlich unproblematischer als für WLAN. 
            Je nach Implementierung kann dies zu einer deutlichen Reduktion
            der Übertragungsrate des WLANs führen; ausserdem kann die Wartezeit
            für das erfolgreiche Senden von Paketen deutlich ansteigen.
            Dies hat die IEEE dazu veranlasst, eine eigene Arbeitsgruppe
            zu gründen, die sich mit dem Problem der gegenseitigen Störung
            von WLAN und Bluetooth zu beschäftigen. Die Ergebnisse dieser
            Arbeitsgruppe spiegeln sich im IEEE 802.15.2 Standard wieder.

        \subsubsection{Leistungsaufnahme}
            Der Energiebedarf für WLAN ist relativ hoch. Beispielsweise benötigt der
            vom Hersteller Broadcom als besonders energiesparend bezeichnete Chip
            BCM4326 bis zu 100mA zum Empfangen und zwischen 141 und 190mA zum Senden.
            \footnote{BCM4326 Datasheet}. 

    \subsection{WPAN: Wireless Personal Area Networks}
        \subsubsection{Übersicht}
            Als WPANs ("`Wireless Personal Area Networks"') werden kabellose Kleinnetzwerke bezeichnet, die dazu dienen,
            wenige Geräte über kurze Entfernungen (mehrere Meter) miteinander zu verbinden. Sie dienen als Ersatz 
            von Kabelverbindungen zur Anbindung von Peripherie an Computergeräte (z.B. zur Verbindung von
            Headsets mit Mobiltelefonen oder von Tastatur und Maus mit einem PC).
            

        \subsubsection{IEEE 802.15}
            Der IEEE 802.15-Standard behandelt \textsl{Wireless Personal Area Networks}. Er ist in mehrere Unterstandards
            aufgeteilt:

             \begin{itemize}
                \item{IEEE 802.15.1:} Bluetooth 1.2
                \item{IEEE 802.15.2:} Zusammenarbeit zwischen IEEE 802.15 (WPAN) und IEEE 802.11 (WLAN)
                \item{IEEE 802.15.3:} WPANs mit hohen Datenübertragungsraten (20MBit/sec und höher)
                \item{IEEE 802.15.4:} WPANs mit niedriger Datenübertragungsraten
            \end{itemize}

            Für diese Arbeit sind vor allem der Bluetooth und der ZigBee Standard interessant. 

        \subsubsection{IEEE 802.15.1: Bluetooth}
            \paragraph{Überblick}
                Bluetooth wurde ursprünglich von dem Mobilfunkhersteller Ericcson als Ersatz für
                RS-232 Verbindungen entwickelt. Die Entwicklung des Bluetooth Standards erfolgt
                heute unter der Regie der \textsl{Bluetooth Special Interest Group} ("`SIG"').
                Version 1.1 des Bluetooth Standard wurde 
                von der IEEE als IEEE 802.15.1-2002 übernommen. Nach Veröffentlichen einer
                weiteren Version IEEE 802.15.1-2005, die dem Bluetooth 1.2 Standard entspricht,
                wurde von der IEEE jedoch beschlossen, nicht weiter mit der \textsl{Bluetooth SIG}
                zu kooperiern, so dass es keine weiteren Versionen des IEEE 802.15.1 Standards 
                geben wird. Aktuell ist Version 4.0 des Bluetooth Standard, wobei jedoch die
                meisten Geräte nur geringere Standards (Typischerweise 2.0 oder 2.1) unterstützen.
                Für den Bluetooth 4.0 Standard existiert zum Zeitpunkt dieser Arbeit keine 
                Implementierung auf dem Markt.\\
                Die wichtigsten Meilensteine der Bluetooth-Entwicklung kann folgendermaßen
                zusammengefasst werden:

                \begin{itemize}
                    \item{Bluetooth 1.1:} Erste Version von praktischer Relevanz. Entspricht 
                                          IEEE 802.15.1-2002.
                    \item{Bluetooth 1.2:} Entspricht IEEE 802.15.2-2005. Bringt einige Verbesserungen
                                          gegenüber der Version 1.1 wie z.B. schnelleres Finden
                                          von Endgeräten (Discovery), höhere Störsicherheit durch
                                          die Verwendung von AFH\footnote{Adaptive frequency-hopping spread spectrum},
                                          Übertragungsraten bis 721kbit/sec.
                    \item{Bluetooth 2.0:} Einführung des EDR\footnote{Enhanced Data Rate}-Modus mit bis zu
                                          3.0 MBit/sec (2.1 MBit/sec netto).
                    \item{Bluetooth 2.1:} Vereinfachung des Pairings (vgl. \ref{BlueetoothPairing}) durch 
                                          Einführung von SSP\footnote{Secure Simple Pairing}, Verbesserung
                                          der Sicherheit durch explizite Aushandlung der Verschlüsselung.
                    \item{Bluetooth 3.0:} Einführung eines Hochgeschwindigkeits-Datenkanals auf Basis von
                                          IEEE 802.11 (vgl. \ref{wlan}) mit bis zu 24MBit/sec., verbessertes
                                          Powermanagement, Einführung von Verbindungslosen Datentelegrammen
                                          (Unicasts).
                    \item{Bluetooth 4.0:} Einführung des \textsl{Blueetooth Low Energy} Standards (vgl. \ref{wibree}).
                \end{itemize}

            \paragraph{Pairing}\label{BluetoothPairing}
                Bei der Entwicklung von Bluetooth wurde ein besonderes Augenmerkt auf Datensicherheit gelegt. 
                Dies liegt daran, dass über Bluetooth in vielen Fällen auf sensible Daten (z.B. der Inhalt
                von Mobiltelefonen, Telefongespräche die über Headsets geführt werden etc.) zugegriffen
                werden kann. Bluetooth verwendet hierfür das Konzept des Pairings, also der Paarung. Bevor zwei 
                Bluetooth Geräte miteinander kommunizieren können, müssen sie gepaart werden. Um dies 
                durchzuführen muss zunächst die Identität der zu paarenden Geräte bestätigt werden.
                Hierzu gibt es zwei verschiedene Verfahren:

                \begin{itemize}
                    \item{Legacy:} Bis Bluetooth 2.0 muss an beiden Geräten eine identische PIN
                                   eingegeben werden. Die PIN ist beliebig und kann bis zu
                                   16 Byte lang sein.
                    \item{Secure Simple Pairing:} Bluetooth 2.1 definiert neben der PIN-Eingabe
                                                  weitere Verfahren zum Paaren von Geräten.
                                                  z.B. kann bei dem \textsl{Just-Works}-Verfahren
                                                  die PIN komplett ausgelassen werden\footnote{Die
                                                  Verbindung erfolgt trotzdem verschlüsselt,
                                                  allerdings sind nun Man-in-the-middle-Angriffe 
                                                  möglich} oder es wird an beiden Geräten eine
                                                  Nummer angezeigt, deren Gleichheit einfach
                                                  nur noch bestätigt werden muss.
                \end{itemize}

                Ist diese Überprüfung erfolgreich generieren beide Geräte einen kryptographischen
                Schlüssel und die weitere Kommunikation erfolgt verschlüsselt. Sobald zwei
                Geräte gepaart wurden können sie miteinader kommunizieren ohne eine erneute
                Paarung durchführen zu müssen.

            \paragraph{Reichweite}
                Bluetooth definiert drei verschiedene Klassen von Geräten mit jeweils
                unterschiedlicher Reichweite:

                \begin{itemize}
                    \item{Klasse 1:} maximale Sendeleistung: 100mW, Reichweite ca. 100m
                    \item{Klasse 2:} maximale Sendeleistung: 2.5mW, Reichweite ca. 10m
                    \item{Klasse 3:} maximale Sendeleistung:   1mw, Reichweite ca. 1m
                \end{itemize}

                Diese Einteilung dient unter anderem der Datensicherheit. Da z.B. 
                ein Headset in der Regel nur die Distanz zwischen Kopf und Tasche
                des Anwenders überbrücken muss reicht hier die Verwendung eines Klasse 2
                Gerätes. Durch die Einschränkung der Sendeleistung wird nicht nur die
                Akkulaufzeit der Geräte erhöht, sondern auch die Wahrscheinlichkeit,
                dass ein Angreifer die gesendeten Daten empfangen kann, verringert.\\
                \\
                % Quelle: Def con
                Es bleibt allerdings festzustellen, dass mit Hilfe von geeigneten
                Antennen die Reichweite von Bluetooth siginfikant gesteigert werden
                kann. So ist es z.B. einer Gruppe von Hackern gelungen, mit Hilfe von
                Yaggi-Antennen mit Bluetooth eine Distanz von über 800m zu überbrücken.
            \paragraph{Übertragungsrate}
                Die Übertragungsrate von Bluetooth hängt natürlich von Faktoren wie
                der Verbindungsqualität und der Entfernung ab. Der Standard definiert
                folgende maximale Datenübertragungsraten:

                \begin{itemize}
                    \item{Bluetooth 1.1:} 721kbit/sec
                    \item{Bluetooth 2.0:} 3.0MBit/sec
                    \item{Bluetooth 3.0:} 24 Mbit/sec (über einen 802.11 Kanal)
                \end{itemize}

            \paragraph{Störsicherheit}
                Bluetooth verwendet einen Frequenzbereich von 2,402 - 2,480 GHz. Innerhalb
                dieses Bereiches werden 79 verschiedene Kanäle definiert. Zur Minimierung
                von Störungen wird sogenannts \textsl{Channel-Hopping} verwendet. Hierbei
                wird der verwendete Kanal bis zu 1600 mal pro Sekunde gewechselt. Mit dem
                Bluetooth 1.2 Standard wurde das verbesserte  
                AFH\footnote{Adaptive frequency-hopping spread spectrum}-Verfahren 
                eingeführt, welches gestörte Kanäle erkennt, und eine Verwendung
                dieser vermeidet.\\
                \\
                Insbesondere WLAN-Netzwerke und Bluetooth Netzwerke stören sich 
                gegenseitig. Wie in Abschnitt \ref{WlanStoersicherheit} bereits
                erläutert wird WLAN deutlich stärker durch Bluetooth gestört
                als dies umgekehrt der Fall wäre. Tritt eine Störung auf einem
                Kanal auf, versucht das AFH-Verfahren die Verwendung dieses
                Kanals zu vermeiden. Hierdurch sinkt zwar die Erreichbare
                Datenübertragungsrate, allerdings kann eine Kommunikation mit
                verminderter Übertragungsrate weiterhin stattfinden.\\
                 \\
                 Es ist festzustellen, dass Bluetooth -- insbesondere im Vergleich
                 zu WLANs -- recht robust gegenüber Störungen ist.

            \paragraph{Anzahl Teilnehmer}
                Sobald zwei oder mehr Geräte miteinader verbunden sind, formen diese ein
                sogenanntes \textsl{Piconet}. In einem \textsl{Piconet} können sich bis
                zu 255 Geräte befinden, wobei ein Gerät eine der folgenden beiden Rollen
                hat:

                \begin{itemize}
                    \item{Master:} Der Master koordiniert die Kommunikation im Netzwerk.
                                   Hierzu gibt er jeweils Zeitslots vor, in denen
                                   Daten gesendet werden dürfen. Pro Piconet kann
                                   es nur einen Master geben.
                    \item{Slaves:} Slaves bekommen vom Master die Erlaubnis, Daten zu senden.
                                   Es können immer nur 7 Slaves gleichzeitig aktiv sein.
                                   Aktive Slaves müssen permanent empfangsbereit sein,
                                   um die Anforderungen des Masters zu empfangen. 
                \end{itemize}

                Da immer nur 7 Slaves gleichzeitig aktiv sein dürfen, befinden sich 
                alle übrigen Slaves im sogenannten \textsl{Parkzustand}. Erst wenn
                ein Slave vom Master explizit dazu aufgeforder wird, darf er in den
                aktiven Zustand wechseln. \\
                \\
                Um die Anzahl der aktiven Geräte in einem Netzwerk zu erhöhen
                gibt es die Möglichkeit, ein sogenanntes Scatternet zu bilden.
                Hierbei handelt es sich um die Verbindung von mehreren Piconets
                mit jeweils maximal 8 Geräten zu einem größeren Verbund. Hierbei
                leitet jeweils ein Gerät, das in jeweils 2 der Piconetze 
                verbunden ist, Pakete vom einen Netz in das andere Netz über.
                Im Vergeleich zu Piconetzen kann hiermit eine deutlich höhere
                Anzahl von Geräten unterstützt werden. Durch die Verkettung 
                der Netzes kann es jedoch vorkommen, dass einzelne Pakete
                eine relativ hohe Anzahl von Piconetzen durchqueren müssen,
                um ihr Ziel zu erreichen.
            \paragraph{Leistungsaufnahme}
                Die genaue Leistungsaufnahme eines Bluetooth Gerätes hängt von 
                einigen Faktoren ab. Den größten Einfluß hat die Rolle des 
                Gerätes: Die Leistungsaufnahme eines \textsl{Slaves} ist
                deutlich höher als die des \textsl{Masters}. Dies liegt
                daran, dass ein \textsl{Slave} immer empfangsbereit sein
                muss, ein Master hingegen nur dann, wenn er Daten von
                einem \textsl{Slave} angefordert hat. Die Leistungsaufnahme
                eines \textsl{Slaves} der Klasse 2 beträgt laut \citep{BluetoothPower}
                durchschnittlich 56,63mW, was bei 3,3V ca 16,6mA entspricht.
                Für Klasse 1 Geräte ist die Leistungsaufnahme noch höher, 
                da alleine die Sendeleistung schon 100mW beträgt.
                Power Management in Bluetooth Netzen ist schwierig. Zwar sind
                einige Standby Modi vorgesehen (Hold, Sniff und Park), allerdings
                muss dem Master erst mitgeteilt werden, dass die entsprechende
                Station für ein bestimmtes Zeitintervall nicht erreichbar ist.
                Befindet sich ein Gerät im Standby-Modus kann es bis zu 3 Sekunden
                dauern, bis es wieder Sendebereit ist. Da diese Einschränkungen
                den Betrieb von Geräten mit geringer Energieversorgung
                praktisch unmöglich machen, wurde von der Bluetooth-SIG
                ein eigener Standard für diese Geräteklasse mit dem Namen
                "`Bluetooth Low Energy"' verabschiedet. Mehr dazu siehe
                Abschnitt~\ref{wibree}.

        \subsubsection{IEEE 802.15.4: ZigBee}

            \paragraph{Übersicht}
                \Abbildungps{!htb}{0.5}{diagramme/Zigbee_stack.pdf}{zigbee_stack}{\emph{ZigBee}-Stack}
                Bei IEEE 802.15.4 handelt es sich um einen Standard für 
                zuverlässige, drahtlose Kommunikation mit niedriger Übertragungsrate
                bei hoher Reichweite, niedriger Leistungsaufnahme und geringem Stückpreis.\\
                \\
                Eine typische Anwendung hierfür sind drahtlose Sensoren: Zum einen
                ist eine möglichst hohe Laufzeit gewünscht, da es oft nur schwer
                möglich ist, Batterien für aufgestellte Sensoren auszutauschen.
                Wenn die Sensoren dazu noch in einer hohen Stückzahl verteilt werden
                sollen, sind möglichst geringe Hardwarekosten notwendig.
                \\
                Es ist wichtig, dass ZigBee nicht das selbe ist wie IEEE 802.15.4.
                IEEE 802.15.4 definiert lediglich die unteren beiden Schichten des
                OSI-Modells, also die Sicherungs- (MAC) und die Physikalische-Schicht 
                (PHY).\\
                Bei ZigBee handelt es sich hingegen um einen kompletten Protokollstapel,
                der den beiden Schichten von IEEE 802.15.4 um 3 weiter Schichten,
                namentlich Vermittlungs-, Verschlüsslungs und Anwendungsschicht 
                ergänzt.  \\
                \\
                Es ist möglich, einen IEEE 802.15.4 Transceiver ohne den Einsatz
                von ZigBee zu betreiben. Die Verwendung von ZigBee bietet jedoch
                den Vorteil, dass alle Netwerkrelevanten Aufgaben wie Routing,
                Übertragungssicherung und Adressierung von Anwendungen bereits
                durch den ZigBee Stack erfolgen, und nicht extra vom Entwickler
                implementiert werden müssen. Die Verwdung von durch die
                ZigBee Alliance zertifizierten Modulen bietet zudem den
                Vorteil der Interoperabilität von Modulen von anderen Herstellen,
                sofern diese ZigBee-zertifiziert sind.

            \paragraph{Netzstruktur}
                ZigBee gibt es zwei Klassen von Geräten:

                \begin{itemize}
                    \item{FFD:} Full Function Devices: Diese Geräte implementieren
                                den vollen ZigBee-Stack. Hierzu ist es notwendig,
                                dass diese immer erreichbar sind; die Verwendung
                                des Energiesparmudus ist nicht möglich.
                    \item{RFD:} Reduced Function Devices: Diese Geräte implementieren
                                nur einen Teil des ZigBee-Stacks. Sie müssen nicht
                                immer ereichbar sein und können den Energiesparmodus
                                benutzen. 
                \end{itemize}

                Es ist lediglich die Kommunikation zwischen RFD und FFD sowie zwischen
                zwei FFDs möglich. Zwei RFDs sind nicht in der Lage, direkt miteinander
                zu kommunizieren sondern müssen den Umweg über ein FFD nehmen.\\
                \\
                Neben den Geräteklassen unterscheiden sich die einzelnen Stationen durch
                die Rollen, die sie im Netzwerk einnehmen:

                \begin{itemize}
                    \item{Koordinator (ZC):} Der Koordinator ist die zentrale Station im Netzwerk.
                                        Er ist der Knoten, der das Netzwerk errichtet hat
                                        und ist für die Kontrolle des Netzwerks zuständig.
                                        In einem Netzwerk kann es immer nur einen Koordinator
                                        geben. Der Koordinator ist immer automatisch auch
                                        ein Router. Die Rolle des Koordinators kann nur von einem
                                        FFD übernommen werden.
                    \item{Router (ZR):} Router sind in einem Netzwerk für die Weiterleitung von
                                   Paketen zuständig. Es kann beliebig viele Router in einem
                                   Netzwerk geben. Die Rolle eines Routers kann nur von einem
                                   FFD übernommen werden.
                    \item{Endknoten (ZED):} Alle Geräte die nicht Koordinator oder Router sind,
                                            sind automatisch Endknoten. Diese leiten keine Pakete
                                            weiter und sind immer an einem Router angemeldet.
                                            Es handelt sich hierbei immer um ein RFD.
                \end{itemize}

                Die Topologie des Netzwerkes wird von den Knoten automatisch bestimmt. Können
                sich mehrere Router empfangen, so bilden diese automatisch ein vollvermaschtes
                Netz. Bei der Zustellung von Paketen wird standardmäßig immer der Pfad mit
                der besten Leitungsqualität gewählt.\\
                \\
                Durch die geschickte Platzierung von Routern kann ein ZigBee Netzwerk
                nahezu beliebig ausgeweitet werden, wobei durch die automatische Organisation
                des Netzwerkes ein hohes Maß an Ausfallsicherheit erreicht werden kann (eine entsprechende
                Anzahl an Routern vorrausgesetzt). Problematisch ist jedoch der Ausfall des
                Koordinators. Prinzipiell kann jeder Router die Aufgabe des Koordinators übernehmen,
                jedoch geschieht dies nicht automatisch und muss in der Anwendungslogik erfolgen.

            \paragraph{Störsicherheit}
                ZigBee verwendet zur funkübertragung von Paketen den IEEE 802.15.4 Standard.
                Dieser weisst große Ähnlichkeiten mit dem IEE 802.11b Standard (WLAN, vgl. 
                Abschnitt~\ref{WlanStoersicherheit}) auf: Es werden mehrere Kanäle im
                2.4GHz Band spezifiziert. In Nordamerika stehen 10 weitere Kanäle im 900MHz-Band
                zur Verfügung, die allerdings eine reduzierte Datenrate von 40KBit/sec besitzen. 
                Darüber hinaus gibt es noch einen Kanal im 868MHz-Band, der allerdings nur in Europa
                verwendet werden darf, und auch nur über 20KBit/sec verfügt.  Zur Übertragung wird auch bei 
                IEEE 802.15.4 Frequenzspreizung nach dem DSSS-Verfahren betrieben. Zum Medienzugriff
                wird das CSMA/CA-Verfahren verwendet.\\
                \\
                Zusätzlich spezifiziert ZigBee auf höherer Ebene eine Reihe von Fehlerbehandlungsroutinen:
                So wird jedes empfangene Paket -- mit der Ausnahme von Broadcasts\footnote{Rundrufe, also
                Pakete, die an alle Stationen gleichzeitig verschickt werden.} -- mit einer Antwort
                an den Sender quittiert. Erhält der Sender innerhalb einer bestimmten Zeitspanne
                keine Antwort, so sendet er das verlorene Paket erneut. Darüber hinaus gibt es in jedem
                Datenpaket eine CRC-Prüfsumme, mit Hilfe derer einfache Bitfehler erkannt werden können.
                Auch in diesem Fall wird das Paket erneut übertragen. Hierbei sollte jedoch bemerkt werden,
                dass eine CRC-Verfahren keinen Schutz gegen absichtliche Manipulation bietet. Diese können
                mit Hilfe der in Abschnitt~\ref{ZigBee Sicherheit} beschriebenen kryptographischen Verfahren
                verhindert werden.\\
                \\
                Ein ZigBee-Netzwerk kann optional ein sogenanntes Beacon (dt. Leuchtfeuer) verwenden. Hierbei
                handelt es sich um ein Signal, dass Periodisch vom Koordinator ausgesendet wird. Mithilfe
                dieses Signals wird die Sendezeit in feste Zeitschlitze eingeteilt. Hiermit ist es möglich, 
                einzelnen Stationen einen garantierten Zeitschlitz (GTS) zuzuweisen, in denen niemand anderes
                senden darf. Dies ist insbesondere für Echtzeitanwendungen interessant. Da zum Zeitpunkt des
                versenden des Beacons jedoch alle Stationen empfangsbereit sein müssen, ergeben sich 
                Einschränkungen für die Batterielaufzeit. Die Verwendung von Beacons schützt nicht gegen
                Störungen durch nicht ZigBee Geräte wie WLANS oder Bluetooth.\\
                \\
                Da die Kanäle ausserhalb des 2,4GHz Bandes eine für diese Arbeit zu geringe Übertragungsrate
                besitzen, sollen im folgenden nur die 15 Kanäle im 2,4 GHz Band betrachtet werden:\\
                \\
                Von den 15 zur Verfügung stehenden Kanälen überschneiden sich 11 mit den 3 überschneidungsfreien 
                IEEE 802.11b 1, 6 und 11 in Nordamerika bzw. 13 mit den Kanälen 1, 7 und 13 in Europa. Es ist zu 
                erwarten, dass die Störungen auf den Kanälen im Randbereich der IEEE 802.11b Kanäle am geringsten --
                wenn auch nicht komplett ausgeschlossen -- ist.
                Ausserdem gibt es auf 4 Kanälen Überschneidungen mit Bluetooth. Der genaue Zusammenhang ist
                in Tabelle~\ref{ZigBee_Kanaele_Ueberschneidung} dargestellt.

                \begin{table}
                    \begin{tabular}{lll}
                        \textbf{ZigBee-Kanal} & \textbf{WLAN-Kanal} & \textbf{Bluetooth Frequenz} \\
                        11           & 1          & -\\
                        12           & 1          & -\\
                        13           & 1          & -\\
                        14           & 1          & 2420 GHz\\
                        15           & -          & -\\
                        16           & 7          & -\\
                        17           & 7          & -\\
                        18           & 7          & 2439 GHz\\
                        19           & 7          & -\\
                        20           & 7          & -\\
                        21           & -          & -\\
                        22           & 13         & -\\
                        23           & 13         & -\\
                        24           & 13         & 2471 GHz\\
                        25           & 13         & -\\
                        26           & 13         & -\\
                    \end{tabular}
                    \label{zigbee_wlan_kanäle}
                    \caption{Überschneidungen zwischen ZigBee, WLAN und Bluetooth-Kanälen}
                \end{table}

                Ein ZigBee Netzwerk ist in der Lage, dynamisch den verwendeten Kanl zu wechseln, sobald die
                Störungen auf einem Kanal zu groß werden. Hierzu wird im EEPROM des ZigBee Gerätes kein fester
                Kanal sondern eine Liste aller erlaubten Kanäle eingestellt. Dies bedeutet, dass bei der
                richtigen Konfiguration des ZigBee Netzwerkes ein einzelnes WLAN durch einen einfachen Signalwechsel
                umgangen werden kann. Problematisch wird es jedoch, wenn mehrere WLANs auf mehrere verschiedenen
                Kanälen gleichzeitig auftreten. Hierdurch kann es zu einer signifikaten Abnahme der im ZigBee-Netzwerk
                möglichen Übertragungsrate kommen. Eine mögliche Lösung wäre in diesem Falle, die WLANs auf
                die WLAN-Kanäle 1, 7 und 13 einzuschränken, so dass für das ZigBee Netzwerk die ZigBee-Kanäle
                15 und 21 zur ungestörten Verwendung zur Verfügung stehen. Alternativ können an Stelle der WLAN-Kanäle 7 
                und 13 die WLAN-Kanäle 6 und 11 verwendet werden, so dass für das ZigBee-Netzwerk die Kanäle 25 und
                26 frei werden.\\
                Wenn für das ZigBee-Netzwerk sowieso nur ein Teil der zur Verfügung stehenden Übertragungsrate benutzt
                wird und auch das WLAN nur teilweise ausgelastet ist, ist zu Erwarten, dass durch die Verwendung
                des CSMA/CA-Verfahrens genügend freie Zeitschlitze gefunden werden können, um selbst bei einer
                hoher WLAN-Dichte noch erfolgreich senden zu können.\\
                \\
                Die Störungen durch Bluetooth sind als weniger Problematisch zu bewerten. Durch das von Bluetooth
                verwendeten FHSS-Verfahren besteht selbst im Worstcase-Fall (Verwendung von sich überschneidenden
                Kanälen im ZigBee-Netz, volle Ausschöpfung der Übertragungsrate im ZigBee-Netz) nur eine maximale
                Kollisionswahrscheinlichkeit von ca. 4\% (3 von 79 Frequenzsprüngen -- unter der Annahme, dass auch
                das ZigBee Netzwerk in dieser Zeit drei mal den Kanal wechselt). Dies kann durch die Fehlerbehandlung
                von ZigBee durch eine Neuübertragung des kollidierten Paketes einfach behandelt werden. Verwendet
                das Bluetooth Netzwerk darüber hinaus das AFH-Verfahren, und ist in der Lage, die Kollision zu
                erkennen, wird es diese Störung erkennen und den betroffenen Kanel im weiteren Verlauf meiden.\\
                \\
                Eine weitere Quelle von Störungen sind Mikrowellenöfen. Diese arbeiten typischerweise
                auf 2540MHz und können Störungen mit einer Bandbreite von bis zu 80MHz und einer Signalstärke
                von bis zu 30dBm verursachen. Hierdurch ergeben sich mögliche Störungen auf den
                oberen ZigBee Kanälen. Da gewöhnliche Mikrowellenöfen für den Haushaltsgebrauch einen 
                Auslastungsgrad von bis zu 50\% haben, ergäbe sich schlimmstenfalls eine halbierung der
                zur Verfügung stehenden Übertragungsrate.\\
                \\
                Die letzte zu erwartende Quelle von Störungen geht von DECT Telefonen aus. Da diese in Europa
                jedoch nicht im 2,4GHz sondern im 1,8GHz-Band arbeiten, stellt dies nur ausserhalb der EU ein
                Problem dar. Hierbei sind schmallbandige Störungen mit einer Signalstärke von bis zu 30dBm 
                zu erwarten. Diese können einfach durch den automatischen Kanalwechsel des ZigBee-Netzwerkes
                umgangen werden.\\

            \paragraph{Verschlüsselung}
                % http://www.willhackforsushi.com/presentations/toorcon11-wright.pdf 
                ZigBee unterstützt 128-Bit AES Verschlüsselung. Hiermit können gesendete Nachrichten 
                gegen Manipulation sowie unberechtigter Kenntnisnahme geschützt werden. Aufgrund von Designschwächen 
                im Standard ist dieser Schutz jedoch nur als rudimentär zu bewerten. Beispielsweise ist
                kein Schutz gegen Replay-Attacken vorgesehen, so dass z.B. Befehle abgefangen und beliebig oft
                wieder in der Netzwerk eingeschleust werden können. Es ist daher sinnvoll, auf höherer 
                Protokollebene weitere Schutzmaßnahmen vorzusehen, um sich erfolgreich gegen Angriffe zu
                schützen.

            \paragraph{Leistungsaufnahme}
                Zur Bewertung der Leistungsaufnahme eines ZigBee-Netzwerkes wird exemplarisch ein ZigBee-Modul
                vom Typ ATZB-24-A2R der Firma Atmel betrachtet. Diese Modul verfügt über einen Energiesparmodus.
                In diesem Modus wird lediglich der interne Speicher mit Energie versorgt, alle weitere Hardware
                wird abgeschaltet. In diesem Modus hat das Gerät (laut Hersteller) einen Strombedarf von weniger als
                6 $\mu{}A$. Befindet sich das Gerät nicht im Energiesparmodus und ist empfangsbereit werden 19 mA
                benötigt, sendet das Gerät sind 18 mA notwendig.\\
                Durch den Energiesparmodus lassen sich große Einsparungen erreichen, allerdings kann dieser nur von 
                RFDs verwendet werden, da FFDs immer empfangsbereit sein müssen. Zur Übertragung von Nachrichten
                wird in diesem Fall von den RFDs ein Polling-Verfahren verwendet: Der Parent des FFDs (in den meisten
                Fällen also der nächstgelegene Router) speichert eine an das RFD gesendete Nachricht so lange zwischen,
                bis dieses die Nachricht abruft. So ist sichergestellt, dass keine Nachrichten verloren gehen, wenn
                sich der Empfänger gerade im Energiesparmodus befindet.
           

        \subsubsection{Bluetooth Low Energy (ehemals Wibree)}\label{wibree}
            Bluetooth Low Energy ist ein neuer Standard für WPANs, der mit dem Bluetooth 4.0 Standard eingeführt
            wurde. Er definiert eine Datenübertragung mit bis zu 1 MBit/s (netto 0.26 MBit/s) bei einem Strombedarf,
            der unter 20mA liegen soll, wobei eine Reichweite von bis zu 100m realisierbar sein soll.\\
            Zum Zeitpunkt dieser Diplomarbeit befanden sich Funkchips des Bluetooth-Low-Energy-Standards noch in 
            der frühen Testphase und waren auf dem Markt nicht erhältlich, so dass dieser Standard bei der Auswahl
            eines geeigneten Funkprotokolls leider nicht in die engere Betrachtung gezogen werden konnte.
            

    \subsection{Weitere Protokolle}
        Neben den oben erwähnten Protokollen gibt es viele weitere kabellose Übertragungsprotokolle wie beispielsweise 
        der kommende Wireless USB-Standards, WiMax, oder Mikrowellen-Richtfunk. Diese Protokolle sind jedoch für die
        Übertragung mit hohen Datenraten ausgelegt (was in der Regel mit einer dementsprechend hohen Leisuntsaufnahme
        einhergeht), und liegen damit ausserhalb des Fokus dieser Arbeit.


    \subsection{Diskussion}
        Von den oben genannten Standards scheidet GSM/UMTS von vorne herein aufgrund der hohen Betriebskosten aus.
        Auch der DECT-Standard kommt nicht in Frage, da die Teilnehmerzahl auf 6 Geräte pro Basisstation beschränkt ist.
        Der WLAN Standard ist zwar grundsätzlich für eine solche Aufgabe geeignet, allerdings fällt der Strombedarf mit
        über 100mA für den Einsatz im Erste-Hilfe-Sensor zu hoch aus. Von der Leistungsaufnahme prinzipiell möglich wäre
        der Einsatz von Bluetooth, wobei insbesondere der kommende Bluetooth Low Energy Standard interessant ist. Auch die
        hohe Störsicherheit wäre ein weitere Punkt, der für Bluetooth spräche. Problematisch ist jedoch die Einschränkung,
        dass pro Bluetooth-Piconetz immer nur 7 Slaves aktiv sein können, dies ist für die Anforderungen dieser Diplomarbeit
        deutlich zu wenig.\\
        \\
        Letztendlich erweist sich der ZigBee-Standard als am besten für die gewünschte Anwendung geeignet. Die erreichte
        Datenrate ist für die Übertragung einiger Messwerte und Alarme mehr als ausreichend. Auch die hohe Störsicherheit,
        die moderaten Stückkosten sowie die vergleichsweise hohe Reichweite sprechen für diese Lösung. 
        Die beiden entscheidenden Kriterien sind jedoch die Fähigkeit von ZigBee, dynamische Meshnetzwerke zu bilden sowie
        die sehr niedrige Leistungsaufname:\\
        Durch die dynamische Vernetzung mit Routern lassen sich auch große Netzwerke realisieren. Das Routing wird komplett
        durch die Firmware der ZigBee-Module übernommen, so dass dieses nicht erst implementiert werden muss. Der Strombedarf
        der Module ist mit maximal 19mA so gering, dass eine Versorgung über Batterien ohne weiteres möglich ist.

\section{Produkte zur Patientenüberwachung}\label{produkte_zur_patientenueberwachung}
Auf dem Markt ist eine breite Palette an kabellosen Produkten zur Patientenüberwachung vorhanden. Die meisten davon setzen
entweder \emph{Bluetooth} oder proprietäre Protokolle wie \emph{Z-Wave} zur Funkübertragung ein, \emph{ZigBee} ist bisher in
keinem Medizinprodukt auf dem Markt zu finden. Fast alle dieser Systeme sind dazu konzipiert, lediglich einen einzelnen 
Patienten zu überwachen. Die Funktechnologie dient hier vor allem dazu, die Anzahl der Kabel zwischen Patient und Monitoren 
zu reduzieren, um so die Mobilität des Patienten zu erhöhen. Besonders häufig sind kabellose EKG-Geräte, Pulsoximeter oder 
invasive Blutdruckmessgeräte anzutreffen. 
-- FIXME: Edit here --

\section{Verwandte Projekte zum Einsatz in MANV-Szenarien}\label{verwandte_projekte}
